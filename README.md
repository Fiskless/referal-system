# Реферальная система

API для реферальной системы

## Демо-версия сайта
Демо-версия сайта расположена на бесплатном хостинге [heroku.com](https://referal-system-fiskless.herokuapp.com/)
Для тестирования возможностей: логин - `fiskless`, пароль - `Asdfgh12345@`


## Запуск

### Инструкция по запуску 

[Установите Python](https://www.python.org/), если этого ещё не сделали.

Проверьте, что `python` установлен и корректно настроен. Запустите его в командной строке:
```sh
python --version
```

Возможно, вместо команды `python` здесь и в остальных инструкциях этого README придётся использовать `python3`. Зависит это от операционной системы и от того, установлен ли у вас Python старой второй версии.

В каталоге проекта создайте виртуальное окружение:
```sh
python -m venv venv
```
Активируйте его. На разных операционных системах это делается разными командами:
- Windows: `.\venv\Scripts\activate`
- MacOS/Linux: `source venv/bin/activate`

Установите зависимости в виртуальное окружение:
```sh
pip install -r requirements.txt
```

В качестве базы данных используется Postgres. Подробное описание о подключении [здесь](https://www.digitalocean.com/community/tutorials/how-to-use-postgresql-with-your-django-application-on-ubuntu-14-04)
После подключения необходимо применить настройки данной СУБД, для этого выполните команду ниже:

```sh
python manage.py migrate
```

Примените миграции:

```sh
python manage.py migrate
```

Запустите сервер:

```sh
python manage.py runserver
```

### Инструкция по запуску через Docker

Запустите базу данных и сайт

```shell-session
$ docker-compose up
```

### Переменные окружения

Часть настроек проекта берётся из переменных окружения. 
Чтобы их определить, создайте файл `.env` рядом с `manage.py` 
и запишите туда данные в таком формате: `ПЕРЕМЕННАЯ=значение`.

Используются следующие переменные окружения: 
- `DEBUG` — дебаг-режим. Поставьте True, чтобы увидеть отладочную информацию в случае ошибки.
- `SECRET_KEY` — секретный ключ проекта
- `ALLOWED_HOSTS` - адреса, на которых будет обслуживаться сайт
- `POSTGRES_DB_URL` - URL вида postgres://username:password@host:port/db_name, в котором содержатся данные о БД, которые распарсятся с [помощью](https://github.com/sloria/environs#usage-with-django)

## Документация по API

### Авторизация по номеру телефона
- Права доступа: `Любой пользователь`
- URL: `users/create/phone`

Эндпоинт для ввода номера телефона

### Оценивание участником другого участника
- Права доступа: `Любой пользователь`
- URL: `/users/create/auth_code`

Эндпоинт для ввода кода авторизации с телефона

### Список участников
- Права доступа: `Авторизованный пользователь`
- URL: `users/<int:pk>/`

Эндпоинт, где выводится информация о профиле пользователя, а также номера 
телефонов пользователей, которые авторизовались по его ссылке

## Технологии
django, djangorestframework, postgresql